<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Random Tab Hopper</title>
  <style>
    :root{
      --bg:#121417; --panel:#1b1f26; --text:#e8ecf1; --muted:#9aa6b2;
      --ok:#35d07f; --warn:#ffb84d; --danger:#ff6b6b; --accent:#5aa9ff;
      --track:#2a313b; --track-fill:#3a6fb2; --thumb:#e8ecf1;
      --btn-gloss-top:rgba(255,255,255,.18); --btn-gloss-bot:rgba(255,255,255,.06);
    }
    html,body{background:var(--bg);color:var(--text)}
    body{font:14px/1.45 system-ui,Segoe UI,Roboto,sans-serif;margin:12px;width:360px}
    .card{background:var(--panel);border-radius:14px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,.35)}
    h3{margin:0 0 10px;font-weight:600;letter-spacing:.2px}

    .row{display:grid;grid-template-columns:1fr 150px;gap:10px;margin:8px 0;align-items:center}
    label{color:var(--muted);font-weight:600}
    input[type=number]{width:100%;padding:6px 8px;border-radius:10px;border:1px solid #2a313b;background:#11161b;color:var(--text)}
    input[type=range]{width:100%}
    .muted{color:var(--muted);font-size:12px}
    .toolbar{display:flex;gap:8px;margin-top:10px}

    .btn{flex:1;padding:9px 10px;border-radius:12px;border:1px solid #2b3340;
         background:linear-gradient(180deg,var(--btn-gloss-top),var(--btn-gloss-bot)),
                   linear-gradient(180deg,#2a3240,#1e2633);color:var(--text);cursor:pointer;
         user-select:none;transition:transform .06s,box-shadow .1s;
         box-shadow:inset 0 1px 0 rgba(255,255,255,.05),0 2px 8px rgba(0,0,0,.3)}
    .btn:hover{transform:translateY(-1px);box-shadow:inset 0 1px 0 rgba(255,255,255,.08),0 4px 12px rgba(0,0,0,.35)}
    .btn-accent{border-color:#2d5f9e;background:linear-gradient(180deg,#3a6fb2,#234a7c)}
    .btn-ok{border-color:#147a46;background:linear-gradient(180deg,#3ac082,#1f7a4f)}
    .btn-warn{border-color:#a66a11;background:linear-gradient(180deg,#e6a23c,#9b671b)}
    .btn-danger{border-color:#8a2222;background:linear-gradient(180deg,#e06565,#962d2d)}

    .toggle{padding:4px 10px;border-radius:10px;border:1px solid #2b3340;background:#1a1f29;color:var(--text);font-size:12px;cursor:pointer}
    .toggle.on{background:#2b7030;border-color:#4c9b3e}

    .status{margin-top:8px;font-weight:600}
    .running{color:var(--ok)} .paused{color:var(--warn)} .stopped{color:var(--danger)}

    /* Dual-handle slider visuals */
    .range-block{grid-column:1/-1;margin-top:6px}
    .range-wrap{
      position:relative;
      height:40px;
    }
    .track{
      position:absolute;
      left:6px;right:6px;top:17px;
      height:6px;border-radius:6px;
      background:var(--track);
      z-index:1;
    }
    .track-fill{
      position:absolute;
      top:17px;
      height:6px;border-radius:6px;
      background:var(--track-fill);
      z-index:2;
    }

    .range{
      position:absolute;
      left:0;right:0;
      appearance:none;
      background:transparent;
      pointer-events:auto;
    }

    .range.min-handle{
      top:0;
      height:20px;
      z-index:3;
    }
    .range.max-handle{
      bottom:0;
      height:20px;
      z-index:3;
    }

    .range::-webkit-slider-thumb{
      appearance:none;width:14px;height:14px;border-radius:50%;background:var(--thumb);
      border:1px solid #000;box-shadow:0 0 0 3px rgba(0,0,0,.15)
    }
    .range::-moz-range-thumb{
      width:14px;height:14px;border-radius:50%;background:var(--thumb);
      border:1px solid #000;box-shadow:0 0 0 3px rgba(0,0,0,.15)
    }
    .range::-webkit-slider-runnable-track{background:transparent}
    .range::-moz-range-track{background:transparent}
    .range.disabled{filter:grayscale(1) brightness(.7)}

    .endcaps{display:flex;justify-content:space-between;margin-top:4px;font-size:12px;color:var(--muted)}
    .slider-disabled{filter:grayscale(1) brightness(.7)}
  </style>
</head>
<body>
  <div class="card">
    <h3>Random Tab Hopper</h3>

    <div class="row">
      <label>Tab start</label>
      <input id="tabStart" type="number" min="1" value="1" />
    </div>
    <div class="row">
      <label>Tab end</label>
      <input id="tabEnd" type="number" min="1" value="9" />
    </div>

    <div class="row">
      <label>Seconds per tab</label>
      <input id="seconds" type="number" min="0.1" step="0.1" value="5" />
    </div>

    <!-- Timing variance (percentage) -->
    <div class="row">
      <label id="jitterLabel">Timing Variance (Â±0%)</label>
      <button id="jitterToggle" class="toggle" aria-pressed="false">OFF</button>
    </div>
    <div class="row">
      <span class="muted">Variance amount</span>
      <div style="display:flex;gap:10px;align-items:center">
        <input id="jitterRange" type="range" min="0" max="100" step="1" value="25" />
        <span id="jitterValue" class="muted">25%</span>
      </div>
    </div>

    <!-- Custom variance range (seconds around base) -->
    <div class="row">
      <label>Custom Variance Range (seconds)</label>
      <button id="rangeToggle" class="toggle" aria-pressed="false">OFF</button>
    </div>

    <div class="range-block">
      <div class="range-wrap" aria-label="Custom variance range in seconds">
        <div class="track"></div>
        <div class="track-fill" id="trackFill" style="left:6%;right:86.7%"></div>

        <input id="minRange" class="range min-handle disabled" type="range"
               min="0.5" max="30" step="0.5" value="1.0">
        <input id="maxRange" class="range max-handle disabled" type="range"
               min="0.5" max="30" step="0.5" value="2.0">
      </div>

      <div class="endcaps">
        <span>Min: <span id="minLabel">1.0s</span></span>
        <span>Max: <span id="maxLabel">2.0s</span></span>
      </div>
      <div class="muted">Randomly offsets the base time earlier or later within this range.</div>
    </div>

    <!-- Manual tab list controls -->
    <div class="row">
      <label>Manual tab list</label>
      <button id="useListToggle" class="toggle" aria-pressed="false">OFF</button>
    </div>
    <div class="row">
      <span class="muted">Selection</span>
      <button id="chooseTabsBtn" class="btn btn-accent" style="padding:5px 8px;">Choose tabs</button>
    </div>
    <div id="selectedTabsContainer"
         class="muted"
         style="max-height:120px;overflow-y:auto;margin-top:4px;font-size:12px;">
      No tabs selected.
    </div>

    <div class="row">
      <label>Total minutes</label>
      <input id="totalMinutes" type="number" min="0.1" step="0.1" value="3" />
    </div>

    <div class="row">
      <label>Mode</label>
      <button id="modeBtn" class="btn btn-accent">Random</button>
    </div>

    <div class="row">
      <label>Stop on human input</label>
      <input id="stopOnHuman" type="checkbox" checked />
    </div>

    <div class="toolbar">
      <button id="startBtn" class="btn btn-ok">Start</button>
      <button id="pauseResumeBtn" class="btn btn-warn">Pause</button>
      <button id="stopBtn" class="btn btn-danger">Stop</button>
    </div>

    <div id="status" class="status stopped">Stopped</div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
